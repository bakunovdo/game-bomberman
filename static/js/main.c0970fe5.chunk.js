(this.webpackJsonpbomberman=this.webpackJsonpbomberman||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var i=n(3),o=n.n(i),a=n(6),s=n.n(a),l=(n(12),n(0)),r=n(4),c=n(1),h=n(2),m=(n(13),function e(t,n){Object(l.a)(this,e),this.x=t,this.y=n}),p=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).moved=!1,o.isAlive=!0,o}return Object(r.a)(n,[{key:"moveUp",value:function(){this.moved||(this.y--,this.moved=!0)}},{key:"moveRight",value:function(){this.moved||(this.x++,this.moved=!0)}},{key:"moveDown",value:function(){this.moved||(this.y++,this.moved=!0)}},{key:"moveLeft",value:function(){this.moved||(this.x--,this.moved=!0)}}]),n}(m),v=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol=" ",o}return n}(m),u=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol="\u25a0",o}return n}(m),y=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol="\u25a1",o}return n}(m),d=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol="B",o.explSymbol="F",o.mapExploded=[],o.drawedMap=!1,o.isExploded=!1,o.explosionFinish=!1,o._sizeExplosion=3,o._explosion=3,o._countdown=6,o}return Object(r.a)(n,[{key:"decreaseCountdown",value:function(){this.isExploded||(this._countdown>0?this._countdown--:this.explode())}},{key:"decreaseExplosion",value:function(){!this.explosionFinish&&this.isExploded&&(this._explosion>0?this._explosion--:this.explosionFinish=!0)}},{key:"createPoint",value:function(e,t){return{x:e,y:t}}},{key:"explode",value:function(){this.isExploded=!0}}]),n}(m),f=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol="P",o.inBombSymbol="\u20b1",o}return n}(p),b=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e,i){var o;return Object(l.a)(this,n),(o=t.call(this,e,i)).symbol="M",o.inBombSymbol="\u1d86",o.actionsTypes={moveUp:"moveUp",moveRight:"moveRight",moveDown:"moveDown",moveLeft:"moveLeft",placeBomb:"placeBomb"},o.mapActions=[{id:1,action:o.actionsTypes.moveUp},{id:2,action:o.actionsTypes.moveRight},{id:3,action:o.actionsTypes.moveDown},{id:4,action:o.actionsTypes.moveLeft},{id:5,action:o.actionsTypes.placeBomb}],o}return n}(p);function x(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}var w=new(function(){function e(t){Object(l.a)(this,e),this.height=t.mapHeight,this.width=t.mapWidth,this.keymap=t.keymap,this.moveDelay=t.moveDelay,this.enemiesCount=t.enemiesCount,this.keymapArray=Object.values(this.keymap),this.AllEnemies=[],this.AllBombs=[],this.moveTimer=null,this.player=null,this.gameOver=!1,this.legend={player:"P",enemy:"M",wall:"\u25a0",space:" ",wrap:"\n",bomb:"B",box:"\u25a1",explosion:"F"},this.blocks=[this.legend.wall,this.legend.bomb,this.legend.box,this.legend.enemy];var n=this.legend.wall,i=this.legend.space,o=this.legend.box;this.classLevelMap=[],this.symbolsLevelMap=[],this.levelMap=[[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,i,i,i,o,i,i,i,i,i,i,i,i,i,n],[n,i,i,i,o,i,i,i,i,i,i,i,i,i,n],[n,i,i,i,o,i,i,i,i,i,i,o,o,o,n],[n,i,i,n,n,n,i,i,i,o,i,i,i,i,n],[n,i,i,i,i,o,i,i,i,i,i,i,i,i,n],[n,i,i,i,i,i,i,i,i,i,i,i,i,i,n],[n,i,i,o,o,i,o,o,o,i,i,o,i,i,n],[n,i,i,i,i,i,i,i,i,i,i,n,i,i,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n]],this.prepare(),this.init()}return Object(r.a)(e,[{key:"prepare",value:function(){this.createClassInMap(),this.spawnPlayer(),this.spawnAllEnemies(),this.isWhiteSpace=this.isWhiteSpace.bind(this),this.movePlayerHandler=this.movePlayerHandler.bind(this)}},{key:"init",value:function(){var e=this;document.addEventListener("keydown",this.movePlayerHandler),this.moveTimer=setInterval((function(){e.player.moved=!1,e.AllBombs.forEach((function(e){e.isExploded?e.decreaseExplosion():e.decreaseCountdown()})),e.AllEnemies.forEach((function(t){t.moved=!1,e.createMoveEnemy(t)}))}),this.moveDelay)}},{key:"createSpawnPoint",value:function(){for(var e,t;e=x(1,this.width-1),t=x(1,this.height-1),!this.isWhiteSpace(e,t););return{x:e,y:t}}},{key:"spawnPlayer",value:function(){var e=this.createSpawnPoint(),t=e.x,n=e.y;this.player=new f(t,n)}},{key:"spawnEnemy",value:function(){var e=this.createSpawnPoint(),t=e.x,n=e.y;this.AllEnemies.push(new b(t,n))}},{key:"spawnAllEnemies",value:function(){for(var e=0;e<this.enemiesCount;e++)this.spawnEnemy()}},{key:"isWhiteSpace",value:function(e,t){return-1===this.blocks.indexOf(this.classLevelMap[t][e].symbol)}},{key:"safeCheck",value:function(e,t){return e>0&&t>0&&e<this.width-1&&t<this.height-1}},{key:"collisionWith",value:function(e,t){try{return this.levelMap[t][e]}catch(n){throw new Error("Check Collision out of the Map")}}},{key:"changeLevelMap",value:function(e,t,n){this.levelMap[t][e]=n,this.createClassInMap()}},{key:"createMoveEnemy",value:function(e){var t,n=e.mapActions,i=e.x,o=e.y,a=n[(t=e.mapActions.length-1,Math.floor(Math.random()*Math.floor(t)+1))].action;a===e.actionsTypes.moveUp&&this.isWhiteSpace(i,o-1)&&e.moveUp(),a===e.actionsTypes.moveRight&&this.isWhiteSpace(i+1,o)&&e.moveRight(),a===e.actionsTypes.moveDown&&this.isWhiteSpace(i,o+1)&&e.moveDown(),a===e.actionsTypes.moveLeft&&this.isWhiteSpace(i-1,o)&&e.moveLeft(),a===e.actionsTypes.placeBomb&&this.AllBombs.push(new d(i,o))}},{key:"movePlayerHandler",value:function(e){var t=this.player,n=this.keymap,i=this.keymapArray,o=this.isWhiteSpace;if(i.includes(e.code)){var a=this.player,s=a.x,l=a.y;e.code===n.moveUp&&o(s,l-1)&&t.moveUp(),e.code===n.moveRight&&o(s+1,l)&&t.moveRight(),e.code===n.moveDown&&o(s,l+1)&&t.moveDown(),e.code===n.moveLeft&&o(s-1,l)&&t.moveLeft(),e.code===n.placeBomb&&this.AllBombs.push(new d(s,l))}}},{key:"deleteFinishedBobs",value:function(){var e=this;this.AllBombs=this.AllBombs.filter((function(t){return t.explosionFinish&&e.changeLevelMap(t.x,t.y,e.legend.space),!t.explosionFinish}))}},{key:"createClassInMap",value:function(){var e=this.legend;this.classLevelMap=this.levelMap.map((function(t,n){return t.map((function(t,i){switch(t){case e.player:return new f(i,n);case e.wall:return new u(i,n);case e.space:return new v(i,n);case e.box:return new y(i,n);case e.bomb:return new d(i,n);default:throw new Error("CreateClassInMap don't implement ".concat(t))}}))}))}},{key:"transformLevelToSymbol",value:function(){var e=this.legend;this.symbolsLevelMap=this.classLevelMap.map((function(e){return e.map((function(e){return e.symbol}))})),this.symbolsLevelMap.forEach((function(t){return t.push(e.wrap)}))}},{key:"renderGame",value:function(){this.transformLevelToSymbol(),this.renderBombs(),this.renderPlayer(),this.renderEnemies()}},{key:"renderPlayer",value:function(){var e=this.player,t=e.x,n=e.y,i=e.symbol,o=e.inBombSymbol;this.symbolsLevelMap[n][t]===this.legend.bomb?this.symbolsLevelMap[n][t]=o:this.symbolsLevelMap[n][t]=i}},{key:"renderEnemies",value:function(){var e=this;this.AllEnemies=this.AllEnemies.filter((function(e){return e.isAlive})),this.AllEnemies.forEach((function(t){var n=t.x,i=t.y,o=t.symbol,a=t.inBombSymbol;e.symbolsLevelMap[i][n]===e.legend.bomb?e.symbolsLevelMap[i][n]=a:e.symbolsLevelMap[i][n]=o}))}},{key:"renderBombs",value:function(){var e=this;this.deleteFinishedBobs(),this.AllBombs.forEach((function(t){var n=t.x,i=t.y,o=t.symbol,a=t.explSymbol;e.changeLevelMap(n,i,o),t.isExploded&&(t.drawedMap||e.drawMapExplosion(t),t.mapExploded.forEach((function(t){e.symbolsLevelMap[t.y][t.x]=a,t.x===e.player.x&&t.y===e.player.y&&(e.gameOver=!0,e.player.isAlive=!1),e.AllEnemies.forEach((function(e){t.x===e.x&&t.y===e.y&&(e.isAlive=!1)}))}))),e.symbolsLevelMap[i][n]=o}))}},{key:"drawMapExplosion",value:function(e){for(var t=this,n=e.x,i=e.y,o=e._sizeExplosion,a=e.createPoint,s=!1,l=!1,r=!1,c=!1,h=function(o){[{dx:0,dy:1,stopExplosion:s,dir:"Up"},{dx:1,dy:0,stopExplosion:l,dir:"Right"},{dx:0,dy:-1,stopExplosion:r,dir:"Down"},{dx:-1,dy:0,stopExplosion:c,dir:"Left"}].forEach((function(h){var m=h.dx,p=h.dy,v=h.stopExplosion,u=h.dir,y=n+m*o,d=i+p*o;if(t.safeCheck(y,d)){var f=t.collisionWith(y,d),b=f===t.legend.space,x=f===t.legend.box;b||v||("Up"===u&&(s=!0),"Right"===u&&(l=!0),"Down"===u&&(r=!0),"Left"===u&&(c=!0)),x&&!v&&t.changeLevelMap(y,d,t.legend.space),t.isWhiteSpace(y,d)&&!v&&e.mapExploded.push(a(y,d))}}))},m=1;m<=o;m++)h(m);e.drawedMap=!0}},{key:"render",value:function(){this.renderGame();var e=this.symbolsLevelMap.map((function(e){return e.join("")})).join("");return"".concat(e)}},{key:"destroy",value:function(){clearInterval(this.moveTimer),document.removeEventListener("keydown",this.movePlayerHandler)}}]),e}())({mapWidth:15,mapHeight:10,enemiesCount:3,moveDelay:500,keymap:{moveUp:"KeyW",moveRight:"KeyD",moveDown:"KeyS",moveLeft:"KeyA",placeBomb:"Space"}}),E=function(e){Object(h.a)(n,e);var t=Object(c.a)(n);function n(e){var i;return Object(l.a)(this,n),(i=t.call(this,e)).state={time:Date.now()},i}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){return e.setState({time:Date.now()})}),50)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h2",null,w.gameOver?"Game Over":"Fight"),o.a.createElement("div",{className:"app"},o.a.createElement("pre",null,w.render())))}}]),n}(o.a.Component);s.a.render(o.a.createElement(E,null),document.getElementById("root"))},7:function(e,t,n){e.exports=n(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.c0970fe5.chunk.js.map